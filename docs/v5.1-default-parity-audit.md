# Lightweight Charts v5.1 Default/Boundary Parity Audit

Date: 2026-02-12

This document tracks default-option parity and section-boundary behavior against TradingView Lightweight Charts v5.1 using official docs references.

## Source references

- https://tradingview.github.io/lightweight-charts/docs/api/interfaces/PriceScaleOptions
- https://tradingview.github.io/lightweight-charts/docs/api/interfaces/TimeScaleOptions
- https://tradingview.github.io/lightweight-charts/docs/api/interfaces/HandleScrollOptions
- https://tradingview.github.io/lightweight-charts/docs/api/interfaces/HandleScaleOptions
- https://tradingview.github.io/lightweight-charts/docs/api/interfaces/CrosshairOptions
- https://tradingview.github.io/lightweight-charts/docs/api/interfaces/CrosshairLineOptions

## Defaults parity matrix

| Area | v5.1 default | chart-rs status | Notes |
|---|---|---|---|
| `crosshair.mode` | `Magnet` | `done` | `ChartEngineConfig` default remains `CrosshairMode::Magnet`. |
| `layout.textColor` | `#191919` | `done` | `RenderStyle` defaults for axis/time labels now use `#191919` equivalent baseline. |
| `layout.fontSize` | `12` | `done` | Default axis/crosshair/last-price label font sizes now align to `12px` baseline. |
| `grid.vertLines/horzLines.color` | `#D6DCDE` | `done` | `RenderStyle` default grid colors updated to `#D6DCDE` equivalent baseline. |
| Time-axis default label policy (timestamp inputs) | adaptive datetime | `done` | `TimeAxisLabelPolicy::default()` now resolves to `UtcAdaptive` for date/time-like defaults closer to Lightweight behavior. |
| Crosshair line visibility | `true` (horz/vert) | `done` | Shared + per-axis gates default enabled. |
| Crosshair line width | `1` | `done` | `RenderStyle::default().crosshair_line_width = 1.0`. |
| Crosshair line style | `LargeDashed` | `done` | Added `LineStrokeStyle::LargeDashed` and made it default for crosshair line style. |
| Crosshair line color | `#758696` | `done` | Default updated to equivalent normalized RGB. |
| Crosshair label background | `#4c525e` | `done` | Default crosshair label box fill/text updated to dark background + white text baseline. |
| `priceScale.mode` | `Normal` | `done` | Mapped to `PriceScaleMode::Linear` baseline. |
| `priceScale.invertScale` | `false` | `done` | Default remains non-inverted. |
| `priceScale.scaleMargins.top` | `0.2` | `done` | Updated `PriceScaleMarginBehavior::default`. |
| `priceScale.scaleMargins.bottom` | `0.1` | `done` | Updated `PriceScaleMarginBehavior::default`. |
| `priceScale.autoScale` | `true` | `done` | `PriceScaleRealtimeBehavior::default()` now enables autoscale on `set_*` and realtime update flows. |
| `priceScale.ticksVisible` | `false` | `done` | Default price-axis tick marks now hidden. |
| `timeScale.rightOffset` | `0` | `done` | Baseline offset remains zero. |
| `timeScale.minBarSpacing` | `0.5` | `done` | Already aligned. |
| `timeScale.fixLeftEdge/fixRightEdge` | `false/false` | `done` | Already aligned. |
| `timeScale.rightBarStaysOnScroll` | `false` | `done` | Already aligned. |
| `timeScale.lockVisibleTimeRangeOnResize` | `false` | `done` | `TimeScaleResizeBehavior::default().lock_visible_range_on_resize` now matches v5.1 (`false`). |
| `timeScale.barSpacing` | `6` | `done` | `TimeScaleNavigationBehavior::default().bar_spacing_px` now defaults to `Some(6.0)`. |
| `handleScroll` (`mouseWheel`, `pressedMouseMove`, `horzTouchDrag`, `vertTouchDrag`) | `true` | `done` | Already aligned. |
| `handleScale.mouseWheel` / `handleScale.pinch` | `true` / `true` | `done` | Already aligned. |
| `handleScale.axisPressedMouseMove` / `axisDoubleClickReset` | `true` / `true` | `done` | Implemented as active gated paths via `axis_drag_scale_price`, `axis_drag_scale_time`, and `axis_double_click_reset_price_scale`, controlled by `scale_axis_pressed_mouse_move` / `scale_axis_double_click_reset` (default `true`). |

## Section boundary parity

Status: `done`

Implemented layout hardening to avoid section overlap:

- Effective axis layout now clamps oversized configured axis dimensions, preserving a minimum non-negative plot section (`min plot width=80px`, `min plot height=56px`).
- Price-axis labels are vertically clamped to plot bounds.
- Last-price label and last-price label box are vertically clamped to plot bounds.
- Crosshair price-axis label box is vertically clamped to plot bounds.
- Crosshair time-axis label box is vertically clamped to time-axis bounds.

Test evidence:

- `tests/render_axis_layout_tests.rs`
- `tests/render_frame_tests.rs`

## Next parity targets

- Validate adaptive axis-section sizing strategy (price/time panel dimensions) against Lightweight Charts visual fixtures to reduce remaining DPI/font-dependent deltas.
