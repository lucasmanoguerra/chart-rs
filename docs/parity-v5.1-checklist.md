# Lightweight Charts v5.1 Parity Checklist

Use this document to track parity progress.

## Status Legend

- `not started`
- `in progress`
- `done`
- `blocked`

## Core

| ID | Area | Feature | Status | Acceptance Criteria | Test Evidence | Notes |
|---|---|---|---|---|---|---|
| C-001 | Time Scale | Logical-to-pixel mapping | done | Matches v5.1 behavior for visible range and spacing | `tests/core_scale_tests.rs`, `tests/property_scale_tests.rs`, `tests/api_tuning_tests.rs` | Full/visible range controls and fit-to-data tuning are implemented. |
| C-002 | Price Scale | Autoscale baseline | done | Stable autoscale with sparse/volatile data | `tests/core_scale_tests.rs`, `tests/property_scale_tests.rs`, `tests/api_tuning_tests.rs`, `tests/api_smoke_tests.rs` | Tuned autoscale for points/candles with padding controls is implemented. |
| C-003 | Series | Candlestick rendering basics | done | OHLC bars render with deterministic geometry | `tests/candlestick_tests.rs`, `tests/candlestick_visible_tests.rs`, `tests/property_candlestick_tests.rs` | OHLC validation, deterministic projection, and visible-range candle projection are implemented. |
| C-004 | Interaction | Crosshair baseline | done | Pointer movement updates crosshair and labels deterministically | `tests/crosshair_tests.rs`, `tests/property_api_tests.rs` | Crosshair now exposes deterministic snapped pixel + logical labels (time/price) for points/candles. |
| C-005 | Interaction | Visible range pan/zoom baseline | done | Drag and zoom operations move visible range deterministically around anchor points | `tests/interaction_pan_zoom_tests.rs`, `tests/property_api_tests.rs` | Time scale pan/zoom APIs are implemented for both logical-time and pixel anchors. |
| C-012 | Interaction | Crosshair normal/magnet mode | done | Crosshair supports deterministic snap-on (`Magnet`) and snap-off (`Normal`) behavior | `tests/crosshair_tests.rs`, `tests/property_api_tests.rs` | Crosshair mode API is implemented and pointer behavior switches deterministically between raw pointer tracking and nearest-sample snapping. |
| C-013 | Interaction | Wheel zoom controller baseline | done | Wheel deltas map to deterministic zoom factors around pixel anchors | `tests/interaction_wheel_zoom_tests.rs`, `tests/property_api_tests.rs` | Wheel zoom API is implemented with explicit notch normalization, input validation, and anchor-stable zoom behavior. |
| C-014 | Interaction | Wheel pan + kinetic pan controller | done | Wheel pan and inertial pan steps update visible range deterministically while preserving span | `tests/interaction_kinetic_pan_tests.rs`, `tests/property_api_tests.rs` | Wheel pan and kinetic pan APIs are implemented with explicit step normalization, tunable decay, and deterministic step-based integration. |
| C-015 | Interaction | Time-scale fixed-edge constraints (`fixLeftEdge`/`fixRightEdge`) | done | Time navigation supports deterministic left/right edge constraints that clamp pan/zoom/set-range behavior against fitted full-range bounds | `tests/time_scale_edge_behavior_tests.rs`, `tests/interaction_pan_zoom_tests.rs` | Added `TimeScaleEdgeBehavior` API (`fix_left_edge`, `fix_right_edge`) and edge-clamp enforcement across range mutation flows (`set_time_visible_range`, pan, zoom, wheel, and fit). |
| C-016 | Interaction | Scroll/scale enable flags parity (`handleScroll`/`handleScale`) | done | Hosts can deterministically enable/disable wheel/drag pan and wheel/pinch zoom paths without side effects in other interaction flows | `tests/interaction_input_behavior_tests.rs`, `tests/interaction_pan_zoom_tests.rs`, `tests/interaction_wheel_zoom_tests.rs` | Added `InteractionInputBehavior` API (`handle_scroll`, `handle_scale`) plus gated input paths (`pan_start/end`, `pan_time_visible_by_pixels`, `wheel_pan_time_visible`, `wheel_zoom_time_visible`, `pinch_zoom_time_visible`) with explicit no-op semantics when disabled. |
| C-017 | Time Scale | Right-offset and logical bar spacing controls | done | Time scale can preserve deterministic right margin and spacing semantics under pan/zoom similar to Lightweight Charts navigation feel | `tests/time_scale_navigation_behavior_tests.rs`, `tests/time_scale_edge_behavior_tests.rs` | Added `TimeScaleNavigationBehavior` (`right_offset_bars`, `bar_spacing_px`) with deterministic range synthesis from data step estimation and viewport width, composed with fixed-edge constraints. |
| C-018 | Time Scale | Visible-range lock on viewport resize | done | Viewport width changes keep deterministic visible-range anchoring policy (including optional right-edge lock) without jump artifacts | `tests/time_scale_resize_behavior_tests.rs`, `tests/time_scale_navigation_behavior_tests.rs` | Added `TimeScaleResizeBehavior` (`lock_visible_range_on_resize`, `anchor`) with deterministic `Left`/`Center`/`Right` anchoring in `set_viewport`, composed with navigation spacing and edge constraints. |
| C-019 | Time Scale | Continuous time-range shift on realtime append | done | Realtime data append can preserve right-edge tracking semantics without forcing full refit and without discontinuities under active offset/spacing policies | `tests/time_scale_realtime_append_behavior_tests.rs`, `tests/time_scale_navigation_behavior_tests.rs` | Added `TimeScaleRealtimeAppendBehavior` (`preserve_right_edge_on_append`, `right_edge_tolerance_bars`) and append-time range updates in `append_point`/`append_candle`, composed with navigation/edge constraints. |
| C-020 | Data | Realtime update append/replace semantics | done | Incremental update API must append when incoming time is newer, replace when incoming time matches latest sample, and reject out-of-order (older) updates deterministically | `tests/realtime_update_semantics_tests.rs`, `tests/time_scale_realtime_append_behavior_tests.rs` | Added `update_point`/`update_candle` API methods with non-decreasing time validation and composition with realtime append follow-tail policy. |
| C-021 | Time Scale | Scroll-to-realtime command parity (`scrollToRealTime`) | done | Host can deterministically reattach visible range to realtime edge, preserving span in free-navigation mode and respecting active navigation/edge constraints | `tests/time_scale_scroll_to_realtime_tests.rs`, `tests/time_scale_navigation_behavior_tests.rs` | Added `scroll_time_to_realtime` API with deterministic behavior for free mode, right-offset/spacing mode, and fixed-edge composition. |
| C-022 | Time Scale | Scroll position introspection and direct positioning (`scrollPosition`/`scrollToPosition`) | done | Host can read deterministic bar-based scroll position and set explicit bar-based right-edge offset while preserving span and honoring edge constraints | `tests/time_scale_scroll_position_tests.rs`, `tests/time_scale_scroll_to_realtime_tests.rs` | Added `time_scroll_position_bars` and `scroll_time_to_position_bars` with deterministic reference-step resolution and explicit invalid-input handling. |
| C-023 | Time Scale | Pixel-based right margin priority (`rightOffsetPixels`) | done | Host can configure deterministic pixel right margin with higher precedence than bar-based right offset, composed with spacing and edge constraints | `tests/time_scale_right_offset_pixels_tests.rs`, `tests/time_scale_scroll_to_realtime_tests.rs` | Added `time_scale_right_offset_px` / `set_time_scale_right_offset_px` with priority semantics over `right_offset_bars` in navigation synthesis. |
| C-024 | Time Scale | Scroll-zoom right-edge anchoring (`rightBarStaysOnScroll`) | done | Host can keep right edge anchored during wheel/pinch zoom when configured, while default behavior remains pointer-anchor zoom | `tests/time_scale_scroll_zoom_behavior_tests.rs`, `tests/interaction_wheel_zoom_tests.rs` | Added `TimeScaleScrollZoomBehavior` (`right_bar_stays_on_scroll`) and integrated anchoring policy into wheel/pinch zoom paths. |
| C-025 | Interaction | Granular scroll/scale input gates parity (`handleScroll`/`handleScale` detailed options) | done | Host can independently enable/disable drag-pan, wheel-pan, wheel-zoom, pinch-zoom, and axis-scale option gates while preserving deterministic no-op semantics for disabled active paths | `tests/interaction_input_behavior_tests.rs`, `tests/chart_config_interaction_behavior_tests.rs`, `tests/interaction_axis_scale_behavior_tests.rs` | Extended `InteractionInputBehavior` with per-input knobs (`scroll_mouse_wheel`, `scroll_pressed_mouse_move`, `scroll_horz_touch_drag`, `scroll_vert_touch_drag`, `scale_mouse_wheel`, `scale_pinch`, `scale_axis_pressed_mouse_move`, `scale_axis_double_click_reset`) and wired active paths (`pan_start/end`, drag pan, wheel pan, wheel zoom, pinch zoom, price-axis drag-scale, axis double-click reset). |
| C-026 | Time Scale | Zoom-spacing limits parity (`minBarSpacing` baseline) | done | Host can enforce deterministic bar-spacing bounds so zoom-out/zoom-in cannot cross configured pixel spacing limits, composed with navigation and edge constraints | `tests/time_scale_zoom_limit_behavior_tests.rs`, `tests/time_scale_navigation_behavior_tests.rs` | Added `TimeScaleZoomLimitBehavior` (`min_bar_spacing_px`, optional `max_bar_spacing_px`) plus constraint integration across range mutation flows and viewport updates. |
| C-027 | Interaction | Crosshair startup mode config parity (`crosshair.mode`) | done | Host can deterministically choose startup crosshair mode through bootstrap config without requiring a post-init setter call | `tests/crosshair_config_behavior_tests.rs`, `tests/crosshair_tests.rs` | Extended `ChartEngineConfig` with `crosshair_mode` + builder `with_crosshair_mode`; engine bootstrap applies configured mode at initialization. |
| C-028 | Price Scale | Realtime autoscale policy on incremental updates | done | Host can opt into deterministic autoscale refresh after append/update flows to keep live price range synchronized without explicit autoscale calls | `tests/price_scale_realtime_behavior_tests.rs` | Added `PriceScaleRealtimeBehavior` (`autoscale_on_data_update`) with best-effort autoscale integration on `append_*`/`update_*` flows, prioritizing candle envelope when candle data exists. |
| C-029 | Interaction | Touch-drag scroll path parity (`horzTouchDrag`/`vertTouchDrag`) | done | Host can deterministically pan time range through touch-style drag input with independent horizontal/vertical gates and no-op semantics when disabled | `tests/interaction_touch_pan_tests.rs`, `tests/interaction_input_behavior_tests.rs` | Added `touch_drag_pan_time_visible(delta_x_px, delta_y_px)` and wired `InteractionInputBehavior` touch gates (`scroll_horz_touch_drag`, `scroll_vert_touch_drag`) with dominant-axis resolution. |
| C-030 | Price Scale | Inverted scale direction parity (`invertScale`) | done | Host can deterministically invert price-axis mapping direction while preserving round-trip conversion and mode/autoscale behavior | `tests/price_scale_invert_behavior_tests.rs`, `tests/price_scale_mode_tests.rs` | Added `set_price_scale_inverted`/`price_scale_inverted` API and core `PriceScale` inverted mapping support preserved across mode switches and autoscale rebuilds. |
| C-031 | Price Scale | Scale margins parity (`scaleMargins`) | done | Host can configure deterministic top/bottom price-scale whitespace margins with validation and preserved behavior across autoscale/mode transitions | `tests/price_scale_margin_behavior_tests.rs`, `tests/price_scale_invert_behavior_tests.rs` | Added `PriceScaleMarginBehavior` and API methods `price_scale_margin_behavior` / `set_price_scale_margin_behavior`, backed by core margin-aware price mapping. |
| C-032 | Interaction | Crosshair hidden mode parity (`CrosshairMode.Hidden`) | done | Host can force crosshair to remain hidden regardless of pointer movement while preserving deterministic mode switching semantics | `tests/crosshair_tests.rs`, `tests/crosshair_config_behavior_tests.rs` | Added `CrosshairMode::Hidden` and interaction-controller handling that keeps crosshair state hidden on pointer moves and when switching mode. |
| C-033 | Price Scale | Autoscale-on-set policy for full data replacement | done | Host can opt into deterministic price autoscale refresh on `set_data`/`set_candles`, independent from append/update autoscale policy | `tests/price_scale_realtime_behavior_tests.rs` | Extended `PriceScaleRealtimeBehavior` with `autoscale_on_data_set` and wired best-effort autoscale integration into full-replacement data paths. |
| C-034 | API | Bootstrap parity for initial price-scale options | done | Host can deterministically bootstrap price-scale mode, inversion, and margins from `ChartEngineConfig` without requiring post-init setter calls | `tests/chart_config_price_scale_behavior_tests.rs` | Extended `ChartEngineConfig` with `price_scale_mode`, `price_scale_inverted`, and `price_scale_margins` plus builder helpers; engine init now applies bootstrap options with validation. |
| C-035 | API | Bootstrap parity for interaction input options | done | Host can deterministically bootstrap interaction input gates from `ChartEngineConfig` without requiring post-init setter calls | `tests/chart_config_interaction_behavior_tests.rs`, `tests/interaction_input_behavior_tests.rs` | Extended `ChartEngineConfig` with `interaction_input_behavior` and `with_interaction_input_behavior`; engine init now applies initial interaction gate policy directly. |
| C-036 | API | Bootstrap parity for time-scale navigation options | done | Host can deterministically bootstrap initial time-scale navigation offset behavior from `ChartEngineConfig` without requiring post-init setter calls | `tests/chart_config_time_scale_behavior_tests.rs`, `tests/time_scale_right_offset_pixels_tests.rs` | Extended `ChartEngineConfig` with `time_scale_navigation_behavior` and `time_scale_right_offset_px` plus builder helpers; engine init applies validated navigation bootstrap options. |
| C-037 | API | Bootstrap parity for price-scale realtime autoscale policy | done | Host can deterministically bootstrap realtime autoscale policy from `ChartEngineConfig` for both set and append/update flows | `tests/chart_config_price_scale_realtime_behavior_tests.rs`, `tests/price_scale_realtime_behavior_tests.rs` | Extended `ChartEngineConfig` with `price_scale_realtime_behavior` and `with_price_scale_realtime_behavior`; engine init now applies policy without post-init setter calls. |
| C-038 | API | Bootstrap parity for time-scale zoom policies | done | Host can deterministically bootstrap scroll-zoom anchoring and zoom-limit policies from `ChartEngineConfig` without post-init setter calls | `tests/chart_config_time_scale_zoom_behavior_tests.rs`, `tests/time_scale_scroll_zoom_behavior_tests.rs`, `tests/time_scale_zoom_limit_behavior_tests.rs` | Extended `ChartEngineConfig` with `time_scale_scroll_zoom_behavior` and `time_scale_zoom_limit_behavior` plus builder helpers; engine init applies validated zoom policy bootstrap options. |
| C-039 | API | Bootstrap parity for time-scale edge/resize/realtime policies | done | Host can deterministically bootstrap edge constraints, resize policy, and realtime-append policy from `ChartEngineConfig` without post-init setter calls | `tests/chart_config_time_scale_policy_behavior_tests.rs`, `tests/time_scale_resize_behavior_tests.rs`, `tests/time_scale_realtime_append_behavior_tests.rs` | Extended `ChartEngineConfig` with `time_scale_edge_behavior`, `time_scale_resize_behavior`, and `time_scale_realtime_append_behavior` plus builder helpers; engine init applies validated policy bootstrap options. |
| C-040 | API | Bootstrap parity for axis-label formatter policies | done | Host can deterministically bootstrap time/price axis label policies from `ChartEngineConfig` without requiring post-init setter calls | `tests/chart_config_axis_label_behavior_tests.rs`, `tests/time_axis_formatter_tests.rs`, `tests/price_axis_formatter_tests.rs` | Extended `ChartEngineConfig` with `time_axis_label_config` and `price_axis_label_config` plus builder helpers; engine init now applies validated axis-label bootstrap options. |
| C-041 | API | Bootstrap parity for last-price source mode policy | done | Host can deterministically bootstrap last-price source selection mode from `ChartEngineConfig` without requiring a post-init style mutation | `tests/chart_config_last_price_source_mode_tests.rs`, `tests/render_frame_tests.rs` | Extended `ChartEngineConfig` with `last_price_source_mode` and `with_last_price_source_mode`; engine init now applies startup `RenderStyle.last_price_source_mode` policy. |
| C-042 | Data | Canonical full-replacement data ordering and dedup semantics | done | Full replacement APIs (`set_data`/`set_candles`) deterministically canonicalize input by filtering invalid samples, sorting by time, and keeping the latest sample per duplicate timestamp | `tests/data_set_canonicalization_tests.rs` | Added deterministic canonicalization pipeline for full replacement data paths with finite/OHLC invariant filtering and duplicate-time replacement semantics. |
| C-043 | API | Last-price behavior controller parity (`priceLineVisible`/`lastValueVisible`/`priceLineSource`) | done | Host can deterministically control last-price line visibility, label visibility, trend-color mode, and source mode through dedicated API methods instead of full style mutation | `tests/last_price_behavior_api_tests.rs`, `tests/render_frame_tests.rs` | Added `LastPriceBehavior` contract and API methods `last_price_behavior` / `set_last_price_behavior` mapped to render-style last-price fields. |
| C-044 | API | Bootstrap parity for last-price behavior policy | done | Host can deterministically bootstrap full last-price behavior policy from `ChartEngineConfig` (line/label visibility, trend-color mode, source mode) without requiring post-init setter calls | `tests/chart_config_last_price_behavior_tests.rs`, `tests/last_price_behavior_api_tests.rs` | Extended `ChartEngineConfig` with optional `last_price_behavior` and builder `with_last_price_behavior`; engine init applies policy with explicit precedence over legacy `last_price_source_mode`. |
| C-045 | Data | Property robustness parity for full-replacement canonicalization | done | Property tests verify deterministic canonicalization invariants for `set_data`/`set_candles` across sparse/extreme/invalid input (sorted unique output, invalid filtering, duplicate replacement semantics) | `tests/property_data_set_canonicalization_tests.rs`, `tests/data_set_canonicalization_tests.rs` | Added dedicated `proptest` coverage for full-replacement canonicalization contracts of points and candles. |
| C-046 | API | Crosshair guide-line visibility controller parity | done | Host can deterministically control shared/per-axis crosshair guide-line visibility through dedicated API methods without mutating full render style | `tests/crosshair_guide_line_behavior_api_tests.rs`, `tests/render_frame_tests.rs` | Added `CrosshairGuideLineBehavior` contract and API methods `crosshair_guide_line_behavior` / `set_crosshair_guide_line_behavior`, mapped to `show_crosshair_lines` + per-axis toggles. |
| C-047 | API | Bootstrap parity for crosshair guide-line visibility policy | done | Host can deterministically bootstrap crosshair guide-line shared/per-axis visibility from `ChartEngineConfig` without requiring post-init setter calls | `tests/chart_config_crosshair_guide_line_behavior_tests.rs`, `tests/crosshair_guide_line_behavior_api_tests.rs` | Extended `ChartEngineConfig` with `crosshair_guide_line_behavior` and builder `with_crosshair_guide_line_behavior`; engine init now applies configured policy. |
| C-048 | API | Crosshair guide-line stroke-style controller parity | done | Host can deterministically control crosshair guide-line shared/per-axis color, width, and stroke style through dedicated API methods without mutating full render style | `tests/crosshair_guide_line_style_behavior_api_tests.rs`, `tests/render_frame_tests.rs` | Added `CrosshairGuideLineStyleBehavior` contract and API methods `crosshair_guide_line_style_behavior` / `set_crosshair_guide_line_style_behavior`, mapped to shared/per-axis guide-line style fields. |
| C-049 | API | Bootstrap parity for crosshair guide-line stroke-style policy | done | Host can deterministically bootstrap crosshair guide-line shared/per-axis stroke-style policy from `ChartEngineConfig` without requiring post-init setter calls | `tests/chart_config_crosshair_guide_line_style_behavior_tests.rs`, `tests/crosshair_guide_line_style_behavior_api_tests.rs` | Extended `ChartEngineConfig` with optional `crosshair_guide_line_style_behavior` and builder `with_crosshair_guide_line_style_behavior`; engine init now applies configured style policy. |
| C-050 | API | Crosshair axis-label visibility controller parity | done | Host can deterministically control crosshair time/price label visibility plus label-box and box-border visibility through dedicated API methods without mutating full render style | `tests/crosshair_axis_label_visibility_behavior_api_tests.rs`, `tests/render_frame_tests.rs` | Added `CrosshairAxisLabelVisibilityBehavior` contract and API methods `crosshair_axis_label_visibility_behavior` / `set_crosshair_axis_label_visibility_behavior` mapped to crosshair axis-label visibility toggles. |
| C-051 | API | Bootstrap parity for crosshair axis-label visibility policy | done | Host can deterministically bootstrap crosshair axis-label visibility toggles from `ChartEngineConfig` without requiring post-init setter calls | `tests/chart_config_crosshair_axis_label_visibility_behavior_tests.rs`, `tests/crosshair_axis_label_visibility_behavior_api_tests.rs` | Extended `ChartEngineConfig` with `crosshair_axis_label_visibility_behavior` and builder `with_crosshair_axis_label_visibility_behavior`; engine init now applies configured visibility policy. |
| C-052 | API | Crosshair axis-label style controller parity | done | Host can deterministically control crosshair time/price label color, font size, axis-offset, and axis-inset behavior through dedicated API methods without mutating full render style | `tests/crosshair_axis_label_style_behavior_api_tests.rs`, `tests/render_frame_tests.rs` | Added `CrosshairAxisLabelStyleBehavior` contract and API methods `crosshair_axis_label_style_behavior` / `set_crosshair_axis_label_style_behavior` mapped to core crosshair axis-label style fields. |
| C-053 | API | Bootstrap parity for crosshair axis-label style policy | done | Host can deterministically bootstrap crosshair axis-label style policy from `ChartEngineConfig` without requiring post-init setter calls | `tests/chart_config_crosshair_axis_label_style_behavior_tests.rs`, `tests/crosshair_axis_label_style_behavior_api_tests.rs` | Extended `ChartEngineConfig` with optional `crosshair_axis_label_style_behavior` and builder `with_crosshair_axis_label_style_behavior`; engine init now applies configured style policy. |
| C-054 | API | Crosshair axis-label box style controller parity | done | Host can deterministically control crosshair time/price label-box fill, border, and corner-radius policies (shared and per-axis) through dedicated API methods without mutating full render style | `tests/crosshair_axis_label_box_style_behavior_api_tests.rs`, `tests/render_frame_tests.rs` | Added `CrosshairAxisLabelBoxStyleBehavior` contract and API methods `crosshair_axis_label_box_style_behavior` / `set_crosshair_axis_label_box_style_behavior` mapped to crosshair label-box style fields. |
| C-055 | API | Bootstrap parity for crosshair axis-label box style policy | done | Host can deterministically bootstrap crosshair axis-label box style policy from `ChartEngineConfig` without requiring post-init setter calls | `tests/chart_config_crosshair_axis_label_box_style_behavior_tests.rs`, `tests/crosshair_axis_label_box_style_behavior_api_tests.rs` | Extended `ChartEngineConfig` with optional `crosshair_axis_label_box_style_behavior` and builder `with_crosshair_axis_label_box_style_behavior`; engine init now applies configured box-style policy. |
| C-056 | Defaults | Lightweight v5.1 baseline defaults alignment | done | Engine defaults align with v5.1 on core knobs available in the Rust API (`priceScale.scaleMargins` baseline, crosshair stroke baseline, and axis tick visibility baseline) | `tests/chart_config_price_scale_behavior_tests.rs`, `tests/price_scale_margin_behavior_tests.rs`, `tests/render_style_tests.rs` | Updated default `priceScale` margins (`top=0.2`, `bottom=0.1`), crosshair stroke baseline to large-dashed family, and default axis tick-mark visibility to `false` to reduce first-render visual divergence versus v5.1. |
| C-057 | Layout | Section-boundary non-overlap policy | done | Rendered labels/boxes are vertically clamped to owning sections (plot/time-axis/price-axis) to prevent panel overlap under edge-pointer and overflow scenarios | `tests/render_axis_layout_tests.rs`, `tests/render_frame_tests.rs` | Hardened price-axis label, last-price label-box, and crosshair axis-label box vertical layout clipping so time-axis and plot-panel primitives remain section-safe. |
| C-058 | Price Scale | Visible-window autoscale integration in time-range flows | done | Host can opt into deterministic visible-window price autoscale refresh on time-range navigation changes (pan/zoom/fit/scroll/resize) without manual autoscale API calls | `tests/price_scale_realtime_behavior_tests.rs`, `tests/chart_config_price_scale_realtime_behavior_tests.rs`, `tests/price_scale_visible_autoscale_behavior_tests.rs` | Extended `PriceScaleRealtimeBehavior` with `autoscale_on_time_range_change` and wired visible-window autoscale into `emit_visible_range_changed` flow, prioritizing candles when candle data exists. |
| C-059 | Layout | Adaptive axis-section sizing baseline | done | Axis sections can adapt deterministically to typography/label content pressure so price/time panel dimensions remain stable under large labels without clipping into plot area | `tests/render_axis_layout_tests.rs`, `tests/render_frame_tests.rs` | Added deterministic adaptive sizing pass in render-frame assembly: time-axis height derives from label/tick extents and price-axis width expands from formatted tick/last-price label width estimates when required. |
| C-060 | Layout | Axis-section visual-fixture corpus baseline | done | Axis-section geometry drift is guarded by deterministic manifest-driven fixtures that validate plot/time/price section signatures under baseline and typography-pressure scenarios | `tests/visual_fixture_axis_section_sizing_tests.rs`, `tests/fixtures/axis_section_sizing/axis_section_sizing_corpus.json` | Added a lightweight fixture corpus with viewport/style manifests and reference layout signatures (`plot_right`, `plot_bottom`, section sizes, label counts) to track future regressions in adaptive sizing behavior. |
| C-061 | Layout | Axis-section PNG reference export baseline | done | Fixture manifests can produce deterministic PNG reference renders for human visual review, and declared artifact paths are validated in test flow | `src/bin/generate_axis_section_fixture_pngs.rs`, `tests/visual_fixture_axis_section_png_artifacts_tests.rs`, `tests/fixtures/axis_section_sizing/reference_png/*.png` | Added manifest-linked PNG export tooling (`cargo run --features cairo-backend --bin generate_axis_section_fixture_pngs`) and artifact-existence checks so visual references stay in sync with fixture corpus. |
| C-062 | Layout | Axis-section extreme/sparse fixture coverage | done | Visual-fixture corpus covers tiny viewport clamps, narrow-domain high-precision labels, and sparse-series wide-range scenarios with stable expected signatures and PNG references | `tests/visual_fixture_axis_section_sizing_tests.rs`, `tests/visual_fixture_axis_section_png_artifacts_tests.rs`, `tests/fixtures/axis_section_sizing/axis_section_sizing_corpus.json`, `tests/fixtures/axis_section_sizing/reference_png/*.png` | Expanded fixture corpus with `tiny-viewport-extreme`, `narrow-domain-high-precision`, and `sparse-series-wide-range` scenarios to harden adaptive-sizing drift detection beyond baseline typography-pressure cases. |
| C-063 | Layout | Axis-section display-mode and extreme-magnitude fixture coverage | done | Visual-fixture corpus covers extreme positive/negative magnitudes and mixed price display modes (`Normal`, `Percentage`, `IndexedTo100`) with deterministic signatures and PNG references | `tests/visual_fixture_axis_section_sizing_tests.rs`, `tests/visual_fixture_axis_section_png_artifacts_tests.rs`, `tests/fixtures/axis_section_sizing/axis_section_sizing_corpus.json`, `tests/fixtures/axis_section_sizing/reference_png/*.png` | Added `extreme-magnitude-normal`, `extreme-magnitude-percentage`, and `extreme-magnitude-indexed-to-100` fixtures to broaden price-label width drift monitoring across display transforms and large-value ranges. |
| C-064 | Layout | Axis-section locale/timezone/session fixture coverage | done | Visual-fixture corpus covers locale-specific axis label text transforms and timezone/session major-tick behavior with deterministic signatures and PNG references | `tests/visual_fixture_axis_section_sizing_tests.rs`, `tests/visual_fixture_axis_section_png_artifacts_tests.rs`, `tests/fixtures/axis_section_sizing/axis_section_sizing_corpus.json`, `tests/fixtures/axis_section_sizing/reference_png/*.png` | Added `locale-enus-utc-session`, `locale-eses-fixed-offset-session`, and `locale-eses-utc-adaptive-no-session` fixtures plus optional textual/tick sentinels (`leftmost_time_label_text`, `top_price_label_text`, `major_time_tick_mark_count`) so locale/timezone drift is detected beyond geometry-only signatures. |
| C-065 | Layout | Axis-section day-rollover and offset-extreme fixture coverage | done | Visual-fixture corpus covers deterministic day-rollover labeling and major-tick behavior under extreme timezone offsets (`UTC+14`, `UTC-12`) with wrap-around session envelopes | `tests/visual_fixture_axis_section_sizing_tests.rs`, `tests/visual_fixture_axis_section_png_artifacts_tests.rs`, `tests/fixtures/axis_section_sizing/axis_section_sizing_corpus.json`, `tests/fixtures/axis_section_sizing/reference_png/*.png` | Added `locale-enus-utcplus14-rollover-session-wrap` and `locale-eses-utcminus12-rollover-session-wrap` fixtures with optional textual/tick sentinels to monitor local-date flip drift near midnight under wrap-around sessions. |
| C-066 | Layout | Axis-section second-level sub-minute fixture coverage | done | Visual-fixture corpus covers `show_seconds=true` under sub-minute spans with and without sessions, validating deterministic second-level label formatting and major-tick behavior | `tests/visual_fixture_axis_section_sizing_tests.rs`, `tests/visual_fixture_axis_section_png_artifacts_tests.rs`, `tests/fixtures/axis_section_sizing/axis_section_sizing_corpus.json`, `tests/fixtures/axis_section_sizing/reference_png/*.png` | Added `seconds-enus-utc-subminute-no-session` and `seconds-eses-fixed-offset-subminute-session` fixtures with optional textual/tick sentinels to monitor second-level formatting drift at high zoom. |
| C-067 | Layout | Axis-section `UtcAdaptive` transition-boundary fixture coverage | done | Visual-fixture corpus covers deterministic `UtcAdaptive` pattern switches around span cutovers (`600s`, `172800s`) between second/minute/date label modes | `tests/visual_fixture_axis_section_sizing_tests.rs`, `tests/visual_fixture_axis_section_png_artifacts_tests.rs`, `tests/fixtures/axis_section_sizing/axis_section_sizing_corpus.json`, `tests/fixtures/axis_section_sizing/reference_png/*.png` | Added `adaptive-enus-span-599s-utc`, `adaptive-enus-span-601s-utc`, `adaptive-eses-span-172799s-utc`, and `adaptive-eses-span-172801s-utc` fixtures with textual/tick sentinels to lock regression coverage for threshold-driven label pattern transitions. |
| C-068 | Layout | Axis-section `LogicalDecimal` high-precision fixture coverage | done | Visual-fixture corpus covers high-precision logical-time formatting (`precision=10`) across `EnUs`/`EsEs`, validating deterministic locale separator behavior and stable section sizing in non-timestamp mode | `tests/visual_fixture_axis_section_sizing_tests.rs`, `tests/visual_fixture_axis_section_png_artifacts_tests.rs`, `tests/fixtures/axis_section_sizing/axis_section_sizing_corpus.json`, `tests/fixtures/axis_section_sizing/reference_png/*.png` | Added `logicaldecimal-enus-precision10` and `logicaldecimal-eses-precision10` fixtures with textual/tick sentinels to lock `.` vs `,` separator behavior and high-precision logical label drift. |
| C-069 | Layout | Axis-section `PriceAxisLabelPolicy::MinMove` trim fixture coverage | done | Visual-fixture corpus covers deterministic `MinMove` rounding output with `trim_trailing_zeros=true/false` across `EnUs`/`EsEs` and validates formatting impact on axis labels | `tests/visual_fixture_axis_section_sizing_tests.rs`, `tests/visual_fixture_axis_section_png_artifacts_tests.rs`, `tests/fixtures/axis_section_sizing/axis_section_sizing_corpus.json`, `tests/fixtures/axis_section_sizing/reference_png/*.png` | Added `minmove-enus-trim-false`, `minmove-enus-trim-true`, `minmove-eses-trim-false`, and `minmove-eses-trim-true` fixtures; sentinels lock trailing-zero behavior (`2.00`/`2` and `2,00`/`2`) plus locale-dependent separators. |
| C-070 | Layout | Axis-section display-mode base fallback (`base_price=None`) fixture coverage | done | Visual-fixture corpus covers deterministic base-price fallback behavior for `Percentage` and `IndexedTo100` display modes when `base_price` is omitted (`None`) and resolved-base fallback must avoid zero-division drift | `tests/visual_fixture_axis_section_sizing_tests.rs`, `tests/visual_fixture_axis_section_png_artifacts_tests.rs`, `tests/fixtures/axis_section_sizing/axis_section_sizing_corpus.json`, `tests/fixtures/axis_section_sizing/reference_png/*.png` | Added `displaymode-percentage-base-none-fallback-one` and `displaymode-indexed-base-none-fallback-one` fixtures with textual/tick sentinels to lock fallback-to-1 formatting behavior under zero-valued anchor data. |
| C-071 | Layout | Axis-section display-mode explicit invalid-base fallback fixture coverage | done | Visual-fixture corpus covers deterministic fallback-to-1 behavior for `Percentage` and `IndexedTo100` with explicit invalid `base_price` inputs (`0`, `NaN`, `+inf`, `-inf`) and keeps stable signatures/PNG references | `tests/visual_fixture_axis_section_sizing_tests.rs`, `tests/visual_fixture_axis_section_png_artifacts_tests.rs`, `tests/price_axis_formatter_tests.rs`, `tests/fixtures/axis_section_sizing/axis_section_sizing_corpus.json`, `tests/fixtures/axis_section_sizing/reference_png/*.png` | Added 8 fixtures: `displaymode-percentage-base-{zero,nan,posinf,neginf}-fallback-one` and `displaymode-indexed-base-{zero,nan,posinf,neginf}-fallback-one`; fixture harness accepts non-finite override tokens for JSON manifests while engine formatting deterministically resolves invalid explicit bases to fallback `1`. |
| C-072 | Layout | Display-mode invalid-base fallback property robustness | done | Property tests verify deterministic `fallback-to-1` behavior equivalence for `Percentage` and `IndexedTo100` when explicit `base_price` is invalid (`0`, `NaN`, `+inf`, `-inf`) across generated datasets/locales | `tests/property_price_axis_display_mode_fallback_tests.rs`, `tests/price_axis_formatter_tests.rs` | Added `proptest` coverage asserting invalid explicit bases produce the same rendered price-axis labels as explicit `base_price=1` for both display transforms, in `EnUs` and `EsEs` locales. |
| C-073 | Layout | Display-mode `base_price=None` fallback property robustness | done | Property tests verify deterministic behavior for `base_price=None`: it matches explicit resolved base when resolved base is finite/non-zero, and matches explicit `base_price=1` when resolved base is zero | `tests/property_price_axis_display_mode_none_fallback_tests.rs` | Added `proptest` coverage for `Percentage` and `IndexedTo100` across generated datasets/locales, asserting equivalence of rendered right-axis labels between `None` and explicit-base configurations under both non-zero-base and zero-base fallback paths. |
| C-074 | Layout | Display-mode domain fallback property robustness without data | done | Property tests verify deterministic `base_price=None` resolution from `price_domain` when no series data is loaded: `domain_min` when finite/non-zero, and fallback `1` when `domain_min` is zero | `tests/property_price_axis_display_mode_domain_fallback_tests.rs` | Added `proptest` coverage for `Percentage` and `IndexedTo100` across locales asserting right-axis label equivalence between `None` and explicit `base_price=domain_min` (non-zero path) or explicit `base_price=1` (zero-domain path). |
| C-075 | Layout | Display-mode fallback formatter/cache benchmark coverage | done | Criterion benchmarks measure deterministic cache-hot and cache-cold formatting costs for `PriceAxisDisplayMode` fallback paths across mixed routes (explicit invalid base, `base_price=None` zero-resolved base, no-data domain fallback), and CI fails when fallback benchmark guardrails regress | `benches/core_math_bench.rs`, `scripts/check_fallback_bench_regressions.py`, `.github/workflows/bench.yml`, `.github/workflows/ci.yml`, `tests/price_axis_formatter_tests.rs` | Added `price_axis_display_mode_fallback_cache_hot_mixed` and `price_axis_display_mode_fallback_cache_cold_mixed` benches, plus CI guardrails (ratio + latency budgets) and API-level cache stats tests for mixed fallback routes. |
| C-076 | Layout | Display-mode fallback locale/suffix property coherence | done | Property tests verify mixed fallback routes preserve display-mode suffix contract (`%` only for `Percentage`) and locale decimal separator contract (`EnUs`=`.`, `EsEs`=`,`) across `Percentage` and `IndexedTo100` | `tests/property_price_axis_display_mode_locale_suffix_fallback_tests.rs` | Added `proptest` scenarios covering five fallback routes (explicit invalid base, `None` with zero/non-zero resolved base from data, and `None` with zero/non-zero domain fallback without data), asserting suffix + separator coherence per locale/mode. |
| C-077 | Layout | Manual `reference_UI` baseline + PR visual review checklist | done | Visual-review process is documented with a fixed manual baseline capture and PR checklist gate for render/layout changes, including standardized review criteria by change type (`layout`, `render`, `formatter`) | `docs/axis-section-visual-fixtures.md`, `.github/PULL_REQUEST_TEMPLATE.md` | Formalized manual baseline capture at `reference_UI/Captura desde 2026-02-12 20-28-20.png`, added PR checklist item requiring visual baseline review for render/layout touchpoints, and standardized typed review checklists to reduce ambiguity. |
| C-078 | Layout | Axis label collision/even-spacing robustness under zoom and scale drag | done | Time/price axis labels remain collision-safe (`min spacing` guards) and keep approximately even axis distribution under zoom range changes, pan shifts, and vertical price-axis drag scaling | `tests/render_axis_layout_tests.rs` | Added regression coverage for zoomed/panned time-axis label spacing and post-`axis_drag_scale_price` price-axis label spacing, locking non-collision and near-even spacing contracts for axis label placement. |
| C-079 | Interaction | Vertical touch-pan validation and normalization hardening | done | `touch_drag_pan_time_visible` validates only enabled touch-pan axes, ignores disabled-axis NaN deltas, and normalizes vertical-driven pan by viewport height (not width) | `src/api/time_scale_controller.rs`, `tests/interaction_touch_pan_tests.rs` | Hardened input validation by axis gate (`scroll_horz_touch_drag` / `scroll_vert_touch_drag`) and made dominant-axis normalization use the corresponding axis span; added regression tests for vertical path scaling and disabled-axis NaN bypass behavior. |
| C-080 | Layout | Zoom-adaptive axis tick density baseline | done | Axis tick/label density changes deterministically with zoom level while preserving min-spacing collision guards and near-even distribution in rendered labels | `src/api/axis_ticks.rs`, `src/api/render_frame_builder.rs`, `tests/render_axis_layout_tests.rs` | Added zoom-adaptive density scaling for time/price tick target counts with spacing-aware caps, plus post-anchor time-label collision filtering to keep rendered labels collision-safe after edge clamping. |
| C-081 | Layout | Extreme zoom axis-density visual-fixture coverage | done | Visual-fixture corpus covers zoom-extreme cadence scenarios with explicit visible-range overrides and keeps signatures/PNGs deterministic under density algorithm changes | `tests/visual_fixture_axis_section_sizing_tests.rs`, `src/bin/generate_axis_section_fixture_pngs.rs`, `tests/fixtures/axis_section_sizing/axis_section_sizing_corpus.json`, `tests/fixtures/axis_section_sizing/reference_png/*.png` | Extended fixture input schema with `time_visible_range_override` and added `zoom-extreme-axis-density-time-out` / `zoom-extreme-axis-density-time-in` fixtures to lock cadence drift under zoom extremes. |
| C-082 | Layout | Lightweight v5.1 directed axis cadence comparison coverage | done | Directed parity tests validate zoom-driven tick cadence expectations for time/price axes against Lightweight Charts v5.1 reference behavior envelope | `tests/lightweight_axis_tick_cadence_reference_tests.rs`, `docs/lightweight-v5.1-axis-cadence-reference.md` | Added targeted time/price cadence comparison tests and a reference note linking Lightweight v5.1 source plus local UI baseline for review context. |
| C-083 | Layout | Axis-density benchmark CI guardrails | done | Criterion benchmarks capture zoom-out and zoom-in axis-density render costs, and CI fails on ratio/latency drift for the zoom-adaptive density path | `benches/core_math_bench.rs`, `scripts/check_axis_density_bench_regressions.py`, `.github/workflows/ci.yml`, `.github/workflows/bench.yml` | Added `axis_density_zoom_adaptive_out_render` / `axis_density_zoom_adaptive_in_render` benches and CI guardrails enforcing zoom-in/out ratio plus absolute latency budgets in focused PR and scheduled benchmark workflows. |
| C-084 | Layout | Zoom-adaptive axis-density intermediate-range calibration | done | Axis tick density uses an explicit non-linear zoom-ratio curve (with neutral band) so intermediate zoom levels produce deterministic cadence progression while preserving collision-safe min-spacing guards | `src/api/axis_ticks.rs`, `src/api/render_frame_builder.rs`, `tests/render_axis_layout_tests.rs`, `tests/lightweight_axis_tick_cadence_reference_tests.rs` | Replaced direct `sqrt` scaling with configurable zoom-ratio density mapping (`density_scale_from_zoom_ratio`) and tightened cadence assertions to lock intermediate progression (`out < mid <= in` with minimum zoom-in gain envelope). |
| C-085 | Layout | Extreme zoom axis-density visual-fixture coverage for price axis | done | Visual-fixture corpus includes dedicated price-axis zoom-out/zoom-in cadence extremes with deterministic signatures/PNGs and fixture controls that keep configured price domains stable under data loading | `tests/fixtures/axis_section_sizing/axis_section_sizing_corpus.json`, `tests/visual_fixture_axis_section_sizing_tests.rs`, `tests/visual_fixture_axis_section_png_artifacts_tests.rs`, `src/bin/generate_axis_section_fixture_pngs.rs`, `tests/fixtures/axis_section_sizing/reference_png/*.png` | Added `zoom-extreme-axis-density-price-out` / `zoom-extreme-axis-density-price-in` fixtures and fixture-runner support for deterministic price-zoom setup (`disable_autoscale_on_data_set`, optional `price_axis_scale_steps`) to guard price-axis cadence drift by signature + PNG. |
| C-086 | Layout | Directed cadence reference expansion for time/price intermediate windows | done | Directed Lightweight v5.1 cadence checks cover additional intermediate zoom windows and multi-step price-scale zoom paths, preserving expected progression envelopes for both axes | `tests/lightweight_axis_tick_cadence_reference_tests.rs`, `tests/render_axis_layout_tests.rs`, `docs/lightweight-v5.1-axis-cadence-reference.md` | Added intermediate-window time-axis cadence assertions (`out < mid1 <= mid2 <= in1 <= in2`) and multi-step price-axis zoom cadence assertions (`out2 <= out1 < baseline < in1 <= in2`) with minimum gain guards against flat zoom progression. |
| C-087 | Interaction | Price-axis vertical pan validation and runtime hardening | done | Price-axis vertical drag-pan is supported through dedicated API with anchor-preserving behavior, finite-input validation, interaction-gate compliance, and long-run stability under repeated drags | `src/api/price_scale_interaction_controller.rs`, `tests/interaction_axis_scale_behavior_tests.rs` | Added `axis_drag_pan_price(drag_delta_y_px, anchor_y_px)` with linear/log mode-safe domain translation, explicit error handling for invalid inputs, no-op behavior when axis scaling is gated off, and regression tests for anchor preservation + prolonged drag stability. |
| C-088 | Layout | Major/minor time-label collision priority hardening | done | Time-axis label collision filtering preserves deterministic min-spacing while prioritizing major ticks/labels under mixed zoom density and keeping major boundary visibility stable | `src/api/axis_ticks.rs`, `src/api/render_frame_builder.rs`, `tests/render_axis_layout_tests.rs`, `tests/fixtures/axis_section_sizing/axis_section_sizing_corpus.json`, `tests/fixtures/axis_section_sizing/reference_png/time-axis-pressure.png` | Added prioritized spacing selector (`select_positions_with_min_spacing_prioritized`) and integrated major-aware label selection so boundary labels are not dropped by nearby minor labels; updated fixture signatures/PNG where cadence output intentionally changed. |
| C-089 | Interaction | Time-axis double-click reset parity hardening | done | Time-axis double-click reset path restores visible range deterministically to full-range domain, respects `scale_axis_double_click_reset` gates, and emits no-op semantics when already reset or gated off | `src/api/time_scale_interaction_controller.rs`, `tests/interaction_axis_scale_behavior_tests.rs`, `tests/interaction_input_behavior_tests.rs` | Added `axis_double_click_reset_time_scale()` to complement price-axis reset parity, with constraint reapplication (`navigation`/`zoom-limit`/`edge`) and deterministic changed/no-change signaling. |
| C-090 | Time Scale | Lightweight-style index/coordinate transform primitives | done | Core exposes deterministic logical-index transform primitives matching Lightweight v5.1 center-of-bar and right-edge formulas (`index -> x`, `x -> logical index`, ceil-discrete conversion, pan right-offset by pixel delta, and anchor-preserving zoom right-offset solve) | `src/core/time_scale.rs`, `tests/time_scale_coordinate_transform_tests.rs` | Added `TimeIndexCoordinateSpace` with explicit formulas (`+0.5` center offset, `-1` right-edge pixel convention) and regression tests for roundtrip math, ceil semantics, pan delta conversion, and zoom-anchor stability. |
| C-091 | Interaction | Runtime adoption of Lightweight-style time index transforms | done | Time zoom/pan interaction paths use Lightweight-style index-space primitives when mathematically consistent, preserving pointer-anchor semantics and right-offset bar math while falling back to existing time-domain flow on mismatch | `src/api/time_scale_controller.rs`, `tests/time_scale_runtime_coordinate_space_tests.rs`, `tests/interaction_pan_zoom_tests.rs`, `tests/time_scale_scroll_zoom_behavior_tests.rs` | Wired `pan_time_visible_by_pixels` and `zoom_time_visible_around_pixel` through `TimeIndexCoordinateSpace` (bar-spacing/right-offset solver) with an anchor-stability guard that safely falls back to the existing time-domain zoom path when index-space assumptions diverge. |
| C-092 | Price Scale | Lightweight-style price coordinate-space primitives | done | Core exposes deterministic transformed-domain `<->` pixel helpers for price-scale mapping with explicit margin/internal-height semantics and inverted-axis support, and `PriceScale` runtime mapping routes through those primitives | `src/core/price_scale.rs`, `tests/price_scale_coordinate_space_tests.rs`, `tests/core_scale_tests.rs` | Added `PriceCoordinateSpace` and `PriceScale::coordinate_space(viewport)`; `price_to_pixel`/`pixel_to_price` now compose through transformed-domain coordinate-space helpers while preserving existing linear/log behavior and roundtrip contracts. |
| C-093 | Interaction | Sparse index nearest-slot parity helper (`ignoreWhitespace`-style) | done | Core exposes deterministic nearest-filled-slot selection for sparse logical-index series, and crosshair snapping paths include the sparse nearest-slot resolver while preserving exact nearest-pixel behavior via correctness fallback | `src/core/time_scale.rs`, `src/api/snap_resolver.rs`, `tests/time_scale_coordinate_transform_tests.rs`, `tests/crosshair_tests.rs` | Added `coordinate_to_nearest_filled_slot` to `TimeIndexCoordinateSpace` (upper-slot tie bias) and integrated sparse-slot snapping hints in data/candle snap resolution with bruteforce consistency fallback to avoid behavioral regressions on irregular/non-index-aligned windows. |
| C-094 | Time Scale | Runtime bar-spacing/right-offset range synthesis parity | done | Runtime time-scale paths can derive visible `barSpacing/rightOffset` from current range and rebuild visible range from explicit spacing/offset values, keeping pan/zoom/navigation flows coherent with Lightweight-style state representation | `src/core/time_scale.rs`, `src/api/time_scale_controller.rs`, `tests/core_scale_tests.rs`, `tests/time_scale_runtime_coordinate_space_tests.rs`, `tests/time_scale_navigation_behavior_tests.rs` | Added `derive_visible_bar_spacing_and_right_offset` plus `set_visible_range_from_bar_spacing_and_right_offset`; pan/zoom and navigation synthesis now route through explicit spacing/offset reconstruction where possible. |
| C-095 | Price Scale | Percentage/indexed core-mode transform parity baseline | done | Core `PriceScaleMode` supports `Percentage` and `IndexedTo100` transformed-domain mapping with deterministic roundtrip coordinate conversion, autoscale compatibility, and axis-drag pan behavior parity with linear-like modes | `src/core/price_scale.rs`, `src/api/price_scale_interaction_controller.rs`, `tests/price_scale_mode_display_transform_tests.rs`, `tests/core_scale_tests.rs` | Added transformed-mode base-value resolution and mapping formulas in core price-scale math (`price <-> transformed domain`), including runtime pan handling for new modes. |
| C-096 | API | Public coordinate->logical-index policy parity (`ignoreWhitespace`) | done | Public API exposes coordinate-to-logical-index mapping with selectable whitespace policy: direct logical-index output or nearest-filled-slot output for sparse datasets | `src/api/mod.rs`, `src/api/scale_access.rs`, `tests/time_scale_coordinate_policy_api_tests.rs` | Added `TimeCoordinateIndexPolicy` and `map_pixel_to_logical_index(pixel, policy)` with `AllowWhitespace` / `IgnoreWhitespace` semantics backed by runtime `TimeIndexCoordinateSpace` nearest-slot resolution. |
| C-097 | Price Scale | Transformed-base explicit/dynamic policy parity | done | Percentage/indexed price-scale modes support deterministic explicit base override and dynamic base sources (data/visible-window extremes) with runtime refresh on data/time-range changes | `src/api/mod.rs`, `src/api/price_scale_access.rs`, `src/api/data_controller.rs`, `src/api/plugin_dispatch.rs`, `tests/price_scale_transformed_base_behavior_tests.rs`, `tests/chart_config_price_scale_behavior_tests.rs` | Added `PriceScaleTransformedBaseBehavior` (`explicit_base_price`, `dynamic_source`) and source enum (`DomainStart`, `FirstData`, `LastData`, `FirstVisibleData`, `LastVisibleData`), plus runtime base refresh hooks and config/bootstrap APIs. |
| C-098 | Time Scale | Extended logical-index coordinate API parity | done | Public API exposes logical-index utilities for host adapters: index->pixel projection and pixel->discrete-index ceil conversion, both compatible with whitespace/ignore-whitespace policy paths | `src/api/scale_access.rs`, `tests/time_scale_coordinate_policy_api_tests.rs` | Added `map_logical_index_to_pixel(logical_index)` and `map_pixel_to_logical_index_ceil(pixel, policy)` to complement existing floating logical-index mapping methods. |
| C-099 | Time Scale | `rightOffsetPixels` + constraints hardening under zoom/resize extremes | done | Time-scale zoom-limit and resize flows preserve `rightOffsetPixels` priority when constraints clamp spans, preventing right-margin drift under extreme zoom/resize combinations | `src/api/time_scale_controller.rs`, `tests/time_scale_zoom_limit_behavior_tests.rs`, `tests/time_scale_resize_behavior_tests.rs` | Hardened zoom-limit navigation path to recompute right edge via `rightOffsetPixels` policy and updated resize lock flow to keep pixel-margin precedence even when resize anchor differs. |
| C-100 | Price Scale | Fine dynamic transformed-base multi-series precedence parity | done | Dynamic transformed-base resolution matches Lightweight-style precedence across points/candles and visible/full windows, including deterministic equal-time tie-break and visible-empty fallback behavior | `src/api/price_scale_access.rs`, `tests/price_scale_transformed_base_behavior_tests.rs` | Refined dynamic base candidate selection so first/last sources compare timestamps across series, ties prefer candles, and visible-window sources fall back to full-data sources when no visible candidate exists. |
| C-101 | API | Logical-index filled-slot introspection and navigation utilities for GTK hosts | done | Host adapters can inspect nearest filled logical slot metadata and navigate sparse logical space via next/previous filled index utilities, alongside existing floating/discrete coordinate conversion APIs | `src/api/mod.rs`, `src/api/scale_access.rs`, `tests/time_scale_coordinate_policy_api_tests.rs` | Added `TimeFilledLogicalSlot`/`TimeFilledLogicalSource` contracts and APIs `nearest_filled_logical_slot_at_pixel`, `next_filled_logical_index`, and `prev_filled_logical_index` for sparse index-aware host tooling. |
| C-102 | Time Scale | Property hardening for `rightOffsetPixels` + zoom-limit/resize/edge constraints | done | Property tests cover numeric stability and constraint invariants under randomized zoom-limit and resize operations with `rightOffsetPixels` and edge clamps, including clamp-path right-margin consistency checks | `tests/property_time_scale_right_offset_constraints_tests.rs`, `tests/time_scale_zoom_limit_behavior_tests.rs`, `tests/time_scale_resize_behavior_tests.rs` | Added `proptest`-driven stress coverage for constrained right-margin behavior and generalized finite-range/edge-clamp invariants across extreme operation sequences. |
| C-103 | Time Scale | Differential parity harness for zoom/pan/`rightOffsetPixels` traces | done | A fixture-driven differential harness replays reference operation traces and validates visible-range/right-margin/scroll-position outputs with explicit tolerance bounds | `tests/lightweight_time_scale_differential_trace_tests.rs`, `tests/fixtures/lightweight_differential/time_scale_zoom_pan_right_offset_pixels_trace.json` | Added a JSON-trace harness that replays navigation, pan, and wheel-zoom flows and checks step-by-step parity metrics against Lightweight-style reference traces. |
| C-104 | Platform GTK | GTK host integration coverage for logical-index filled-slot utilities | done | GTK adapter exposes nearest filled-slot introspection and sparse next/previous navigation helpers, with adapter-level regression coverage | `src/platform_gtk/mod.rs` | Added GTK bridge methods for logical-index utilities (`map_*`, `nearest_filled_logical_slot_at_pixel`, `next_filled_logical_index`, `prev_filled_logical_index`) and adapter tests validating sparse-slot behavior. |
| C-105 | Bench | Bench coverage for transformed-base dynamic refresh and sparse logical-index lookups | done | Criterion includes dedicated anti-regression benches for transformed-base refresh across visible-window changes and sparse logical-index lookup paths | `benches/core_math_bench.rs` | Added benches for dynamic transformed-base refresh (`LastVisibleData`) and sparse helper hot paths (`nearest`, `next/prev filled`) to guard latency regressions. |
| C-106 | Tooling | Differential trace import/export automation for Lightweight playback | done | Tooling supports importing Lightweight-style captured traces and exporting chart-rs replay traces with deterministic step metrics for time-scale, price-scale, and interaction scenarios | `src/bin/differential_trace_tool.rs` | Added `differential_trace_tool` with `import/export` commands for time/price/interaction differential traces, including exporter replay for deterministic `expect` generation and unit coverage for import/export core flows. |
| C-107 | Price Scale | Differential parity harness for transformed modes + visible autoscale | done | Fixture-driven differential tests validate transformed-base and visible-autoscale behavior (`Percentage`/`IndexedTo100`) against recorded Lightweight-style step traces (base/domain/probe mappings) | `tests/lightweight_price_scale_differential_trace_tests.rs`, `tests/fixtures/lightweight_differential/price_scale_transformed_autoscale_trace.json` | Added replay harness with probe-value parity assertions for transformed base resolution, visible-window transitions, append impact, and autoscale domain updates. |
| C-108 | CI | Guardrails for new transformed-base/sparse-index parity benches | done | CI and scheduled benchmark workflows fail on latency/ratio drift across the new parity benches (`dynamic base refresh`, `sparse nearest`, `sparse next/prev`) | `scripts/check_new_parity_bench_regressions.py`, `.github/workflows/ci.yml`, `.github/workflows/bench.yml` | Added focused benchmark guard script with mean/ratio budgets and wired it into PR and scheduled benchmark workflows. |
| C-109 | Interaction | Differential parity harness for wheel/pinch/kinetic + crosshair transitions | done | Fixture-driven differential tests replay advanced interaction traces and validate time-range evolution, kinetic-state decay, and crosshair visibility/snap transitions with tolerance bounds | `tests/lightweight_interaction_differential_trace_tests.rs`, `tests/fixtures/lightweight_differential/interaction_zoom_pan_kinetic_crosshair_trace.json`, `src/bin/differential_trace_tool.rs` | Added interaction differential replay coverage (`wheel_pan`, `wheel_zoom`, `pinch_zoom`, kinetic start/step, crosshair mode + pointer transitions) and extended trace tooling with `export/import-interaction` commands. |
| C-110 | Render | Visual differential PNG harness with tolerance budgets | done | Fixture corpus compares rendered Cairo PNG outputs against committed Lightweight-style baselines with explicit max/mean channel-diff tolerances, and exposes deterministic baseline-regeneration workflow | `tests/lightweight_visual_differential_tests.rs`, `tests/fixtures/lightweight_visual_differential/visual_baseline_corpus.json`, `tests/fixtures/lightweight_visual_differential/reference_png/` | Added fixture-driven visual diff harness (`max_channel_abs_diff`, `mean_channel_abs_diff`) plus ignored regeneration utility to refresh baseline PNG references deterministically. Baseline sync maintenance on 2026-02-13 refreshed `lwc-style-line-basic`, `lwc-style-percentage-window`, and `lwc-style-candles-log-axis-scale-price` PNG references after default-style parity alignment. |
| C-111 | Robustness | Property/fuzz hardening for extreme scale round-trip under transforms/constraints | done | Property tests cover numeric round-trip stability for price/time mappings under transformed modes, margin changes, rightOffsetPixels, zoom-limit clamps, resize operations, and sparse logical-index mappings | `tests/property_extreme_scale_roundtrip_tests.rs` | Added `proptest` stress coverage for extreme price/time coordinate round-trips across transformed price modes (`Linear/Log/Percentage/IndexedTo100`), viewport resizing, and constrained time-scale operation sequences. |
| C-112 | Tooling | Direct differential trace import from raw Lightweight captures (no manual normalization) | done | Differential tooling imports raw Lightweight event captures directly, preserving mixed event naming and mapping wheel/touch/crosshair flows into replayable interaction traces with optional observed expectations | `src/bin/differential_trace_tool.rs`, `tests/lightweight_raw_capture_import_tests.rs`, `tests/fixtures/lightweight_differential/lightweight_real_capture_interaction.raw.json`, `tests/fixtures/lightweight_differential/lightweight_real_capture_interaction_trace.json` | Added `import-lwc-interaction` command path with direct event-kind/field alias mapping (`wheel`, `touch_move`, `crosshair_*`, kinetic aliases) and regression coverage proving raw capture conversion without manual normalization. |
| C-113 | Render | Expanded visual parity corpus (candles/OHLC, log-scale, session/timezone, axis drag-scale) | done | Visual differential corpus includes candlestick/log-scale and timezone/session fixtures with axis drag-scale actions for both price and time axes, each guarded by deterministic per-fixture diff budgets | `tests/lightweight_visual_differential_tests.rs`, `tests/fixtures/lightweight_visual_differential/visual_baseline_corpus.json`, `tests/fixtures/lightweight_visual_differential/reference_png/lwc-style-candles-log-axis-scale-price.png`, `tests/fixtures/lightweight_visual_differential/reference_png/lwc-style-timescale-session-timezone-axis-scale.png` | Extended the visual harness schema for candle data and axis/time label configs, added axis drag-scale replay actions, and committed two new Lightweight-style baseline PNG fixtures covering log-price and session/timezone time-scale paths. |
| C-114 | CI | Guardrails for C-110/C-111 (visual diff + property stress profile) | done | CI runs a dedicated parity guard job that fails on visual-diff drift and runs elevated proptest stress for extreme round-trip invariants, independent from the general test job | `.github/workflows/ci.yml`, `tests/lightweight_visual_differential_tests.rs`, `tests/property_extreme_scale_roundtrip_tests.rs` | Added `parity_visual_property_guard` workflow job executing the visual baseline diff test and an explicit proptest stress profile (`PROPTEST_CASES`, `PROPTEST_MAX_SHRINK_ITERS`) for continuous anti-regression coverage. |
| C-115 | Tooling | Differential visual trace bridge from raw Lightweight captures to auto-generated visual corpus | done | Tooling imports raw Lightweight visual captures directly and emits ready-to-run visual corpus fixtures (with baseline PNG paths and mapped visual actions) without manual normalization | `src/bin/differential_trace_tool.rs`, `tests/lightweight_visual_raw_capture_import_tests.rs`, `tests/fixtures/lightweight_differential/lightweight_real_capture_visual.raw.json`, `tests/fixtures/lightweight_visual_differential/lightweight_real_capture_visual_imported_corpus.json` | Added `import-lwc-visual` command with mixed naming alias mapping for visual events (`price_scale_mode`, `axis_scale_price/time`, `crosshair_*`, visible-range updates), automatic baseline path generation, and regression coverage for real-capture import output. |
| C-116 | Interaction | Advanced touch interaction differential corpus (pinch multi-step + kinetic decay envelope + gap snap) | done | Differential interaction corpus includes advanced touch scenarios with multi-step pinch zoom, multi-step kinetic decay envelopes, and magnet crosshair snap behavior over sparse data gaps | `tests/fixtures/lightweight_differential/interaction_zoom_pan_kinetic_crosshair_trace.input.json`, `tests/fixtures/lightweight_differential/interaction_zoom_pan_kinetic_crosshair_trace.json`, `tests/lightweight_interaction_differential_trace_tests.rs` | Added `touch-pinch-kinetic-gap-snap-advanced` scenario and exported expectations, plus dedicated regression assertions for pinch-step coverage, monotonic kinetic velocity decay across steps, and non-trivial magnet snap displacement in sparse-gap contexts. |
| C-117 | CI | Visual diff artifact workflow for parity triage | done | CI parity guard uploads per-fixture visual artifacts (`actual`, `baseline`, `diff`, `summary`) for audit/debug on both pass and fail paths | `.github/workflows/ci.yml`, `tests/lightweight_visual_differential_tests.rs` | Extended visual differential test harness to emit artifact packs when `LIGHTWEIGHT_VISUAL_DIFF_ARTIFACT_DIR` is set, and wired CI to publish artifacts via `actions/upload-artifact` from the dedicated parity guard job. |
| C-006 | Series | Line series projection baseline | done | Line data maps to deterministic segment geometry over active scales | `tests/line_series_tests.rs`, `tests/property_line_series_tests.rs` | Core and API line-segment projection helpers are implemented. |
| C-007 | Series | Visible data window selection | done | Point/candle series can be filtered by visible logical range with deterministic ordering | `tests/visible_data_window_tests.rs`, `tests/property_api_tests.rs` | Core windowing helpers and API visible-window methods (with overscan) are implemented. |
| C-008 | Series | Area series projection baseline | done | Area data maps to deterministic line/fill geometry over active scales | `tests/area_series_tests.rs`, `tests/property_area_series_tests.rs` | Core and API area geometry projection (visible + overscan variants) are implemented with explicit baseline-closed polygons. |
| C-009 | Series | Baseline series projection baseline | done | Baseline data maps to deterministic line + above/below fill geometry over active scales | `tests/baseline_series_tests.rs`, `tests/property_baseline_series_tests.rs` | Core and API baseline geometry projection (visible + overscan variants) are implemented with explicit baseline-closed polygons and clamped split regions. |
| C-010 | Series | Histogram series projection baseline | done | Histogram values map to deterministic bar geometry anchored to a baseline | `tests/histogram_series_tests.rs`, `tests/property_histogram_series_tests.rs` | Core and API histogram projection (visible + overscan variants) are implemented with explicit bar width validation and baseline anchoring. |
| C-011 | Series | OHLC bar series projection baseline | done | OHLC bars map to deterministic stem/tick geometry over active scales | `tests/bar_series_tests.rs`, `tests/property_bar_series_tests.rs` | Core and API bar projection (visible + overscan variants) are implemented with explicit tick width validation and OHLC ordering invariants. |

## Render

| ID | Area | Feature | Status | Acceptance Criteria | Test Evidence | Notes |
|---|---|---|---|---|---|---|
| R-001 | Pipeline | Render frame + Cairo/Pango backend baseline | done | Engine builds deterministic render commands and Cairo backend draws series + axis labels | `tests/render_frame_tests.rs`, `tests/property_render_frame_tests.rs`, `tests/render_cairo_backend_tests.rs`, `benches/core_math_bench.rs` | `RenderFrame` now carries explicit line/text primitives, with deterministic axis tick labels and GTK draw-context support. |
| R-002 | Price Axis | Tick density + collision strategy | done | Price/time labels keep deterministic spacing and avoid overlap in narrow viewports | `tests/render_axis_layout_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Axis labels now use deterministic density selection and spacing-based collision filtering for narrow and wide layouts. |
| R-003 | Time Axis | Time formatter and locale policy | done | Time labels support deterministic built-in policies, locale presets, and injectable custom formatter logic | `tests/time_axis_formatter_tests.rs`, `tests/property_render_frame_tests.rs` | Added decimal + UTC datetime policies, `en-US/es-ES` locale presets, and runtime custom formatter injection. |
| R-004 | Price Scale | Visual parity styling baseline | done | Render output includes deterministic grid/axis styling close to Lightweight Charts conventions | `tests/render_style_tests.rs`, `tests/render_cairo_backend_tests.rs`, `benches/core_math_bench.rs` | Added configurable render style contract (grid, axis borders, label colors, scale panel sizing) and plot/axis panel split in frame generation. |
| R-005 | Time Axis | Zoom-aware formatter + label cache | done | Time labels adapt formatting by visible-span zoom level and repeated redraws reuse cached formatted labels deterministically | `tests/time_axis_formatter_tests.rs`, `benches/core_math_bench.rs` | Added `UtcAdaptive` formatter policy and in-engine time-label cache with hit/miss stats for redraw optimization. |
| R-006 | Time Axis | Session boundary/timezone-aware labeling | done | Time labels support trading-session boundaries and configurable timezone alignment | `tests/time_axis_formatter_tests.rs`, `benches/core_math_bench.rs` | Added fixed-offset timezone alignment and optional session envelope that keeps boundary labels explicit while collapsing in-session intraday labels to time-only format. |
| R-007 | Time Axis | Major tick visual emphasis | done | Session/day boundary ticks render with deterministic major grid/label styling | `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added major tick classification (session boundary + local midnight) with configurable major grid color/width and label font size. |
| R-008 | Price Axis | Formatter precision/min-move policy | done | Price labels support fixed/adaptive precision, min-move rounding, and custom formatter injection | `tests/price_axis_formatter_tests.rs`, `benches/core_math_bench.rs` | Added `PriceAxisLabelPolicy` (`FixedDecimals`/`Adaptive`/`MinMove`) with deterministic min-move snapping and locale-aware formatting. |
| R-009 | Price Axis | Display mode parity (normal/percent/indexed) | done | Price labels support deterministic normal/percentage/indexed-to-100 modes with configurable/derived base values | `tests/price_axis_formatter_tests.rs`, `benches/core_math_bench.rs` | Added `PriceAxisDisplayMode` with percent suffix behavior and explicit/derived base-price transforms. |
| R-010 | Price Scale | Linear/log mode baseline | done | Price scale supports deterministic linear/log mapping, mode switching, and log-safe autoscale behavior | `tests/core_scale_tests.rs`, `tests/price_scale_mode_tests.rs`, `benches/core_math_bench.rs` | Added `PriceScaleMode` (`Linear`/`Log`), API mode switching, and log-domain tick/autoscale handling. |
| R-011 | Price Axis | Log tick ladder parity (1/2/5 decades) | done | Log-mode ticks/labels prefer deterministic 1/2/5 * 10^n levels and preserve domain direction | `tests/core_scale_tests.rs`, `tests/price_axis_formatter_tests.rs`, `benches/core_math_bench.rs` | Added log ladder tick generation with deterministic downsampling and endpoint preservation. |
| R-012 | Price Axis | Label cache baseline | done | Repeated redraws reuse deterministic cached price-axis labels across built-in/custom formatter paths | `tests/price_axis_formatter_tests.rs`, `benches/core_math_bench.rs` | Added cache stats/clear APIs and deterministic cache-key profiles for built-in/custom formatters. |
| R-013 | Price Axis | Last price line + label baseline | done | Render frame includes deterministic latest-price marker line/label with configurable style toggles | `tests/render_frame_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added latest-price marker rendering using newest point/candle sample, with style knobs for line/label colors, widths, and visibility. |
| R-014 | Price Axis | Last-price label collision filter | done | Price-axis labels avoid overlap with last-price label via deterministic exclusion radius and fallback label retention | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added configurable `last_price_label_exclusion_px` filter for axis labels near the last-price marker. |
| R-015 | Price Axis | Last-price trend color policy | done | Last-price marker can switch to deterministic up/down/neutral coloring based on latest vs previous visible sample | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style trend-color knobs and optional trend-driven color selection for last-price line/label. |
| R-016 | Price Axis | Last-price source mode policy | done | Last-price marker can deterministically target newest full-series sample or newest visible-range sample under pan/zoom | `tests/render_frame_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added `LastPriceSourceMode` (`LatestData`/`LatestVisible`) and style-level source selection for last-price marker resolution. |
| R-017 | Price Axis | Last-price label box visual parity | done | Last-price axis label can render a deterministic filled price-box with configurable color/padding and text contrast | `tests/render_frame_tests.rs`, `tests/render_cairo_backend_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added `RectPrimitive` render support and optional style-driven last-price label box rendering in axis panel. |
| R-018 | Price Axis | Label-box border/radius + auto-contrast policy | done | Last-price label box supports deterministic border and corner radius plus automatic text contrast for bright/dark fills | `tests/render_frame_tests.rs`, `tests/render_cairo_backend_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added styled `RectPrimitive` border/radius fields, rounded-box Cairo path rendering, and optional automatic box-text contrast policy. |
| R-019 | Price Axis | Label-box fit-text width + horizontal padding policy | done | Last-price label box can use deterministic full-axis or fit-text width mode with configurable horizontal padding and minimum width | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added `LastPriceLabelBoxWidthMode` (`FullAxis`/`FitText`) with deterministic text-width estimation and width clamping to axis panel. |
| R-020 | Price Axis | Axis label inset + tick-mark length policy | done | Price-axis labels and tick marks use deterministic, configurable horizontal inset and extension length | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs for right inset and tick-mark length, applied to both regular price labels and last-price label anchor path. |
| R-021 | Price Axis | Dedicated tick-mark color/width style policy | done | Price-axis tick marks can be styled independently from axis border color/width while keeping deterministic geometry | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `price_axis_tick_mark_color` and `price_axis_tick_mark_width` for short horizontal price-axis marks. |
| R-022 | Price Axis | Axis label typography + vertical offset policy | done | Price-axis labels support deterministic configurable font size and vertical offset from tick Y | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `price_axis_label_font_size_px` and `price_axis_label_offset_y_px` replacing fixed axis-label constants. |
| R-023 | Price Axis | Last-price label vertical offset policy | done | Last-price axis label uses deterministic configurable vertical offset from marker Y | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knob `last_price_label_offset_y_px` replacing fixed formula coupling to font size. |
| R-024 | Price Axis | Last-price label right inset policy | done | Last-price label can use deterministic right inset independent from regular axis-label inset when box mode is disabled | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knob `last_price_label_padding_right_px` and independent anchor resolution for non-box last-price labels. |
| R-025 | Price Axis | Tick-mark visibility policy | done | Price-axis short tick marks can be deterministically enabled/disabled without affecting label/grid generation | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knob `show_price_axis_tick_marks` for visibility control of horizontal price-axis marks. |
| R-026 | Price Axis | Horizontal grid-line visibility policy | done | Price-axis horizontal grid lines can be deterministically enabled/disabled while labels/tick-marks remain independent | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knob `show_price_axis_grid_lines` for horizontal price-axis grid visibility control. |
| R-027 | Price Axis | Regular label visibility policy | done | Price-axis regular labels can be deterministically enabled/disabled while last-price label remains independently configurable | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knob `show_price_axis_labels` for visibility control of non-marker price-axis labels. |
| R-028 | Price Axis | Dedicated horizontal grid-line style policy | done | Price-axis horizontal grid lines support dedicated deterministic color/width styling independent from time-grid lines | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `price_axis_grid_line_color` and `price_axis_grid_line_width` for axis-specific horizontal grid styling. |
| R-029 | Time Axis | Regular label typography + offset + tick-length policy | done | Time-axis regular labels and short axis tick marks use deterministic configurable font size, vertical anchor offset, and tick length | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `time_axis_label_font_size_px`, `time_axis_label_offset_y_px`, and `time_axis_tick_mark_length_px` replacing fixed time-axis constants. |
| R-030 | Time Axis | Regular label visibility policy | done | Time-axis regular labels can be deterministically enabled/disabled while grid lines and tick marks remain independent | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knob `show_time_axis_labels` for visibility control of regular time-axis labels. |
| R-031 | Time Axis | Tick-mark visibility policy | done | Time-axis short tick marks can be deterministically enabled/disabled while grid lines and labels remain independent | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knob `show_time_axis_tick_marks` for visibility control of short time-axis tick marks. |
| R-032 | Time Axis | Dedicated tick-mark style policy | done | Time-axis short tick marks support deterministic dedicated color/width styling independent from axis-border style | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `time_axis_tick_mark_color` and `time_axis_tick_mark_width` for short time-axis tick styling. |
| R-033 | Time Axis | Dedicated label color policy | done | Time-axis labels support deterministic dedicated color styling independent from price-axis label color | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knob `time_axis_label_color` for time-axis label color control. |
| R-034 | Time Axis | Major-label visibility policy | done | Major time-axis labels can be deterministically enabled/disabled without affecting regular time labels | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knob `show_major_time_labels` for visibility control of major time-axis labels. |
| R-035 | Time Axis | Major-grid visibility policy | done | Major time-axis grid lines can be deterministically enabled/disabled without affecting regular time grid lines | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knob `show_major_time_grid_lines` for visibility control of major time-axis grid lines. |
| R-036 | Time Axis | Dedicated major-label color policy | done | Major time-axis labels support deterministic dedicated color styling independent from regular time-axis label color | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knob `major_time_label_color` for major time-axis label color control. |
| R-037 | Time Axis | Dedicated major tick-mark style policy | done | Major time-axis tick marks support deterministic dedicated color/width styling independent from regular time-axis tick marks | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `major_time_tick_mark_color` and `major_time_tick_mark_width` for major time-axis tick-mark styling. |
| R-038 | Time Axis | Dedicated major tick-mark length policy | done | Major time-axis tick marks support deterministic dedicated length independent from regular time-axis tick-mark length | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knob `major_time_tick_mark_length_px` for major time-axis tick-mark length control. |
| R-039 | Time Axis | Major tick-mark visibility policy | done | Major time-axis tick marks can be deterministically enabled/disabled without affecting regular time-axis tick marks | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knob `show_major_time_tick_marks` for major time-axis tick-mark visibility control. |
| R-040 | Time Axis | Dedicated major-label vertical offset policy | done | Major time-axis labels support deterministic dedicated vertical offset independent from regular time-axis labels | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knob `major_time_label_offset_y_px` for major time-axis label Y-offset control. |
| R-041 | Axes | Time-axis border visibility policy | done | Bottom time-axis border can be deterministically enabled/disabled without affecting right price-axis border | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knob `show_time_axis_border` for bottom axis border visibility control. |
| R-042 | Axes | Price-axis border visibility policy | done | Right price-axis border can be deterministically enabled/disabled without affecting bottom time-axis border | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `benches/core_math_bench.rs` | Added render-style knob `show_price_axis_border` for right axis border visibility control. |
| R-043 | Crosshair | Crosshair guide-line render baseline | done | Crosshair renders deterministic horizontal/vertical guide lines in the plot pane, using snapped coordinates in magnet mode and style-level visibility toggles | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_line_color`, `crosshair_line_width`, `show_crosshair_horizontal_line`, and `show_crosshair_vertical_line`. |
| R-044 | Crosshair | Crosshair axis-label baseline | done | Crosshair renders deterministic time/price axis labels using snapped values in magnet mode and independent visibility toggles | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_time_label_color`, `crosshair_price_label_color`, `crosshair_axis_label_font_size_px`, `show_crosshair_time_label`, and `show_crosshair_price_label`. |
| R-045 | Crosshair | Crosshair axis-label box baseline | done | Crosshair time/price axis labels can render deterministic fit-text background boxes with configurable fill/padding and independent time/price visibility toggles | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_label_box_color`, `crosshair_label_box_padding_x_px`, `crosshair_label_box_padding_y_px`, `show_crosshair_time_label_box`, and `show_crosshair_price_label_box`. |
| R-046 | Crosshair | Crosshair axis-label box border/radius policy | done | Crosshair axis-label boxes support deterministic border width/color and corner-radius styling with safe radius clamping | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_label_box_border_width_px`, `crosshair_label_box_border_color`, and `crosshair_label_box_corner_radius_px`. |
| R-047 | Crosshair | Crosshair axis-label box auto-contrast text policy | done | Crosshair axis-label boxes support deterministic text color auto-contrast based on fill luminance with configurable manual override | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_label_box_text_color` and `crosshair_label_box_auto_text_contrast`. |
| R-048 | Crosshair | Crosshair axis-label box width-mode policy | done | Crosshair axis-label boxes support deterministic `FitText`/`FullAxis` width modes for both time and price axis panels | `tests/render_frame_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knob `crosshair_label_box_width_mode` with `CrosshairLabelBoxWidthMode::{FitText, FullAxis}`. |
| R-049 | Crosshair | Crosshair axis-label box border visibility policy | done | Crosshair axis-label box borders can be deterministically enabled/disabled independently for time and price axis labels | `tests/render_frame_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `show_crosshair_time_label_box_border` and `show_crosshair_price_label_box_border`. |
| R-050 | Crosshair | Crosshair axis-label vertical offset policy | done | Crosshair time and price axis labels support deterministic dedicated vertical offsets independent from regular axis-label offsets | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_time_label_offset_y_px` and `crosshair_price_label_offset_y_px`. |
| R-051 | Crosshair | Crosshair axis-label horizontal inset policy | done | Crosshair time and price axis labels support deterministic dedicated horizontal insets independent from regular axis-label insets | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_time_label_padding_x_px` and `crosshair_price_label_padding_right_px`. |
| R-052 | Crosshair | Crosshair axis-label font-size policy | done | Crosshair time and price axis labels support deterministic dedicated font-size controls independent from each other | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_time_label_font_size_px` and `crosshair_price_label_font_size_px`. |
| R-053 | Crosshair | Crosshair axis-label box padding policy per axis | done | Crosshair time and price axis-label boxes support deterministic independent horizontal/vertical padding controls | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_time_label_box_padding_x_px`, `crosshair_time_label_box_padding_y_px`, `crosshair_price_label_box_padding_x_px`, and `crosshair_price_label_box_padding_y_px`. |
| R-054 | Crosshair | Crosshair axis-label box border style policy per axis | done | Crosshair time and price axis-label boxes support deterministic independent border color/width controls | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_time_label_box_border_color`, `crosshair_time_label_box_border_width_px`, `crosshair_price_label_box_border_color`, and `crosshair_price_label_box_border_width_px`. |
| R-055 | Crosshair | Crosshair axis-label box corner-radius policy per axis | done | Crosshair time and price axis-label boxes support deterministic independent corner-radius controls with safe clamping | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_time_label_box_corner_radius_px` and `crosshair_price_label_box_corner_radius_px`. |
| R-056 | Crosshair | Crosshair axis-label box width-mode policy per axis | done | Crosshair time and price axis-label boxes support deterministic independent `FitText`/`FullAxis` width-mode controls with shared fallback compatibility | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_time_label_box_width_mode` and `crosshair_price_label_box_width_mode` (`Option<CrosshairLabelBoxWidthMode>` fallback to shared `crosshair_label_box_width_mode`). |
| R-057 | Crosshair | Crosshair axis-label box text policy per axis | done | Crosshair time and price axis-label boxes support deterministic independent manual text color and auto-contrast policies with shared fallback compatibility | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_time_label_box_text_color`, `crosshair_price_label_box_text_color`, `crosshair_time_label_box_auto_text_contrast`, and `crosshair_price_label_box_auto_text_contrast`. |
| R-058 | Crosshair | Crosshair axis-label box fill-color policy per axis | done | Crosshair time and price axis-label boxes support deterministic independent fill colors with shared fallback compatibility and per-axis auto-contrast input color | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_time_label_box_color` and `crosshair_price_label_box_color`. |
| R-059 | Crosshair | Crosshair axis-label box min-width policy per axis | done | Crosshair time and price axis-label boxes support deterministic independent minimum-width controls with shared fallback compatibility | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_label_box_min_width_px`, `crosshair_time_label_box_min_width_px`, and `crosshair_price_label_box_min_width_px`. |
| R-060 | Crosshair | Crosshair axis-label box text-alignment policy per axis | done | Crosshair time and price axis-label boxes support deterministic independent text alignment controls with optional shared fallback | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_label_box_text_h_align`, `crosshair_time_label_box_text_h_align`, and `crosshair_price_label_box_text_h_align`. |
| R-061 | Crosshair | Crosshair axis-label box vertical-anchor policy per axis | done | Crosshair time and price axis-label boxes support deterministic independent vertical-anchor controls with optional shared fallback | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_label_box_vertical_anchor`, `crosshair_time_label_box_vertical_anchor`, and `crosshair_price_label_box_vertical_anchor` using `CrosshairLabelBoxVerticalAnchor::{Top, Center, Bottom}`. |
| R-062 | Crosshair | Crosshair axis-label box horizontal-anchor policy per axis | done | Crosshair time and price axis-label boxes support deterministic independent horizontal-anchor controls with optional shared fallback | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_label_box_horizontal_anchor`, `crosshair_time_label_box_horizontal_anchor`, and `crosshair_price_label_box_horizontal_anchor` using `CrosshairLabelBoxHorizontalAnchor::{Left, Center, Right}`. |
| R-063 | Crosshair | Crosshair axis-label box overflow policy per axis | done | Crosshair time and price axis-label boxes support deterministic independent overflow policies (`ClipToAxis`/`AllowOverflow`) with optional shared fallback | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_label_box_overflow_policy`, `crosshair_time_label_box_overflow_policy`, and `crosshair_price_label_box_overflow_policy` using `CrosshairLabelBoxOverflowPolicy::{ClipToAxis, AllowOverflow}`. |
| R-064 | Crosshair | Crosshair axis-label box visibility-priority policy per axis | done | Crosshair time and price axis-label boxes support deterministic per-axis visibility-priority resolution when box rectangles overlap | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_label_box_visibility_priority`, `crosshair_time_label_box_visibility_priority`, and `crosshair_price_label_box_visibility_priority` using `CrosshairLabelBoxVisibilityPriority::{KeepBoth, PreferTime, PreferPrice}`. |
| R-065 | Crosshair | Crosshair axis-label box clipping-margin policy per axis | done | Crosshair time and price axis-label boxes support deterministic independent clipping margins when overflow policy is `ClipToAxis`, with shared fallback compatibility | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_label_box_clip_margin_px`, `crosshair_time_label_box_clip_margin_px`, and `crosshair_price_label_box_clip_margin_px`. |
| R-066 | Crosshair | Crosshair axis-label box jitter-stabilization policy per axis | done | Crosshair time and price axis-label boxes support deterministic independent stabilization steps (position quantization in px) with shared fallback compatibility | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_label_box_stabilization_step_px`, `crosshair_time_label_box_stabilization_step_px`, and `crosshair_price_label_box_stabilization_step_px`. |
| R-067 | Crosshair | Crosshair axis-label box z-order policy per axis | done | Crosshair time and price axis-label boxes support deterministic independent z-order controls with shared fallback compatibility | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_label_box_z_order_policy`, `crosshair_time_label_box_z_order_policy`, and `crosshair_price_label_box_z_order_policy` using `CrosshairLabelBoxZOrderPolicy::{PriceAboveTime, TimeAbovePrice}`. |
| R-068 | Crosshair | Crosshair guide-line stroke-style policy per axis | done | Crosshair horizontal and vertical guide lines support deterministic independent stroke-style controls (`Solid`/`Dashed`/`Dotted`) with shared fallback compatibility | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_line_style`, `crosshair_horizontal_line_style`, and `crosshair_vertical_line_style` using `LineStrokeStyle::{Solid, Dashed, Dotted}`. |
| R-069 | Crosshair | Crosshair guide-line color policy per axis | done | Crosshair horizontal and vertical guide lines support deterministic independent color controls with shared fallback compatibility | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_horizontal_line_color` and `crosshair_vertical_line_color` (`Option<Color>`) with fallback to shared `crosshair_line_color`. |
| R-070 | Crosshair | Crosshair guide-line width policy per axis | done | Crosshair horizontal and vertical guide lines support deterministic independent width controls with shared fallback compatibility | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_horizontal_line_width` and `crosshair_vertical_line_width` (`Option<f64>`) with fallback to shared `crosshair_line_width`. |
| R-071 | Crosshair | Crosshair guide-line combined visibility gate cleanup | done | Crosshair guide lines support deterministic shared visibility gating combined with per-axis toggles (`shared && axis`) | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added shared render-style knob `show_crosshair_lines` while preserving existing per-axis toggles `show_crosshair_horizontal_line` and `show_crosshair_vertical_line`. |
| R-072 | Crosshair | Crosshair axis-label formatter override per axis | done | Crosshair time and price labels support deterministic independent formatter overrides with fallback to existing axis formatter policies | `tests/render_frame_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added API methods `set/clear_crosshair_time_label_formatter` and `set/clear_crosshair_price_label_formatter`; overrides apply only to crosshair labels and keep axis-label formatting behavior unchanged. |
| R-073 | Crosshair | Crosshair axis-label formatter fallback/cache policy per axis | done | Crosshair formatter overrides use deterministic per-axis cache keys/stats with explicit fallback to existing axis-label formatter/cache behavior when override is absent | `tests/render_frame_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added dedicated cache stats/clear APIs for crosshair formatters (`crosshair_time_label_cache_stats`, `clear_crosshair_time_label_cache`, `crosshair_price_label_cache_stats`, `clear_crosshair_price_label_cache`) and generation-based cache invalidation on formatter updates. |
| R-074 | Crosshair | Crosshair axis-label text transform policy per axis (prefix/suffix) | done | Crosshair time and price labels support deterministic prefix/suffix transforms with shared fallback and independent per-axis overrides | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_label_prefix`, `crosshair_label_suffix`, `crosshair_time_label_prefix`, `crosshair_time_label_suffix`, `crosshair_price_label_prefix`, and `crosshair_price_label_suffix`; transforms are applied only to crosshair axis labels after formatter/fallback resolution. |
| R-075 | Crosshair | Crosshair axis-label numeric precision policy per axis | done | Crosshair time and price labels support deterministic numeric precision overrides with shared fallback and independent per-axis precision controls | `tests/render_frame_tests.rs`, `tests/render_style_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added render-style knobs `crosshair_label_numeric_precision`, `crosshair_time_label_numeric_precision`, and `crosshair_price_label_numeric_precision`; precision overrides are applied only to crosshair labels while regular axis labels keep existing policies. |
| R-076 | Crosshair | Crosshair axis-label formatter context policy (time span/source mode) | done | Crosshair time and price formatter overrides can receive deterministic context including visible time span and crosshair source mode (snapped vs projected) per axis | `tests/render_frame_tests.rs`, `tests/property_render_frame_tests.rs`, `benches/core_math_bench.rs` | Added context-aware formatter APIs (`set/clear_crosshair_time_label_formatter_with_context`, `set/clear_crosshair_price_label_formatter_with_context`) and public context contracts (`CrosshairTimeLabelFormatterContext`, `CrosshairPriceLabelFormatterContext`, `CrosshairLabelSourceMode`). |
| R-077 | Crosshair | Crosshair axis-label formatter context cache-key policy per axis | done | Context-aware crosshair formatter overrides use deterministic cache keys that partition by formatter generation, source mode, visible span, and axis value quantization | `tests/render_frame_tests.rs`, `benches/core_math_bench.rs` | Extended crosshair formatter cache-profile keys to include context dimensions (`source_mode`, `visible_span`) for both time and price context formatters, preserving per-axis cache stats behavior. |
| R-078 | Crosshair | Crosshair axis-label formatter context invalidation lifecycle | done | Context-aware crosshair formatter caches are invalidated deterministically on context lifecycle transitions (crosshair-mode changes and visible-range changes) | `tests/render_frame_tests.rs` | Added lifecycle invalidation hooks so context-aware crosshair caches clear on `set_crosshair_mode` and `VisibleRangeChanged` flow (`set/pan/zoom/fit/reset` time-range operations). |
| R-079 | Crosshair | Crosshair axis-label formatter context snapshot/export parity | done | Engine snapshots export deterministic crosshair formatter state (override mode per axis + formatter generations) for regression tooling | `tests/api_snapshot_tests.rs`, `tests/property_api_tests.rs` | Added snapshot contract fields `crosshair_formatter.{time_override_mode,price_override_mode,time_formatter_generation,price_formatter_generation}` using `CrosshairFormatterOverrideMode::{None,Legacy,Context}`. |
| R-080 | Crosshair | Crosshair axis-label formatter context API hardening | done | Public API exposes deterministic override-mode and generation introspection per axis, preventing ambiguous host-side formatter lifecycle state | `tests/api_snapshot_tests.rs` | Added APIs `crosshair_time_label_formatter_override_mode`, `crosshair_price_label_formatter_override_mode`, and `crosshair_label_formatter_generations`; snapshot export now reuses these accessors for consistency. |
| R-081 | Crosshair | Crosshair formatter lifecycle property coverage | done | Property tests validate deterministic lifecycle behavior across legacy/context formatter transitions, context invalidation triggers, and snapshot JSON roundtrip parity | `tests/property_api_tests.rs` | Added property scenario covering mixed set/clear operations for legacy/context formatters, crosshair mode/range transitions, deterministic snapshot equality, and roundtrip consistency of exported formatter state. |
| R-082 | Crosshair | GTK/Relm4 integration docs/examples for context formatters | done | Developer docs provide practical, deterministic integration pattern for context-aware crosshair formatters in GTK4/Relm4 host apps | `docs/gtk-relm4-crosshair-formatters.md`, `docs/developer-guide.md` | Added end-to-end integration guide covering engine setup, formatter closures, pointer event wiring, lifecycle invalidation semantics, and host-side diagnostics recommendations. |
| R-083 | Crosshair | Crosshair formatter diagnostics API | done | Public API exposes consolidated diagnostics for crosshair formatter state (override modes, generations, and per-axis cache stats) for host observability/debug tooling | `tests/api_snapshot_tests.rs` | Added `crosshair_formatter_diagnostics` and `clear_crosshair_formatter_caches` API methods with `CrosshairFormatterDiagnostics` contract for deterministic host-side diagnostics. |
| R-084 | Crosshair | Benchmark lifecycle transitions + context cache-hot path | done | Criterion covers deterministic crosshair formatter lifecycle transitions (mode/range) while measuring cache-hot contextual formatter behavior | `benches/core_math_bench.rs` | Added benchmark `bench_crosshair_axis_label_formatter_context_lifecycle_transitions` to exercise repeated pointer/render under crosshair-mode and visible-range transitions. |
| R-085 | Crosshair | Technical API contract matrix for legacy/context per-axis behavior | done | Technical docs include explicit per-axis contract matrix mapping lifecycle actions to override mode, stored formatter slots, generation updates, and shared lifecycle rules | `docs/crosshair-formatter-contract-matrix.md`, `docs/developer-guide.md`, `docs/architecture.md` | Added dedicated matrix document and linked it from developer/architecture docs for host-side integration and debugging consistency. |
| R-086 | Crosshair | Snapshot/diagnostics API coherence hardening tests | done | Tests enforce deterministic coherence between `EngineSnapshot.crosshair_formatter` and `crosshair_formatter_diagnostics()` across mixed lifecycle transitions and cache operations | `tests/api_snapshot_tests.rs`, `tests/property_api_tests.rs` | Added integration and property coverage that assert per-axis override modes/generations stay aligned between snapshot export and diagnostics surface. |
| R-087 | Crosshair | Crosshair formatter diagnostics JSON export contract | done | Diagnostics state has stable JSON export methods for raw and versioned contract payloads | `src/api/json_contract.rs`, `tests/api_snapshot_tests.rs` | Added `crosshair_formatter_diagnostics_json_pretty` and `crosshair_formatter_diagnostics_json_contract_v1_pretty`, plus compatibility parser for raw/contract payloads. |
| R-088 | Crosshair | Snapshot/diagnostics backward-compat schema guard | done | Snapshot and diagnostics payloads support versioned contract wrappers with schema-version guardrails and backward-compatible parsing of legacy raw payloads | `src/api/json_contract.rs`, `tests/api_snapshot_tests.rs`, `tests/property_api_tests.rs` | Added schema constants, contract payload structs, and `from_json_compat_str` parsers for `EngineSnapshot` and `CrosshairFormatterDiagnostics`. |
| R-089 | Crosshair | GTK/Relm4 diagnostics bridge hooks | done | GTK adapter can publish formatter diagnostics and versioned snapshot JSON during draw lifecycle through host hooks without coupling UI code to engine internals | `src/platform_gtk/mod.rs`, `docs/gtk-relm4-crosshair-formatters.md` | Added hook APIs (`set/clear_crosshair_diagnostics_hook`, `set/clear_snapshot_json_hook`) and pull helpers for diagnostics/snapshot contract export. |

## Extensions

| ID | Area | Feature | Status | Acceptance Criteria | Test Evidence | Notes |
|---|---|---|---|---|---|---|
| E-001 | Markers | Advanced marker placement | done | Marker collision and alignment match expected rules | `tests/markers_tests.rs`, `tests/property_markers_tests.rs` | Deterministic marker placement with lane-based collision avoidance and visible-window projection is implemented. |
| E-002 | Plugins | Custom extension hooks | done | Extension points allow bounded custom logic without core coupling | `tests/plugins_tests.rs` | Plugin hooks with deterministic event dispatch and read-only engine context are implemented in the `extensions` layer. |
